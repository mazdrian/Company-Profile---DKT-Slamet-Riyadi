{% extends "base.html" %}

{% block title %}Edit Dokter{% endblock %}

{% block content %}
<div class="pt-32 pb-16 min-h-screen bg-gray-50 dark:bg-gray-900 flex justify-center items-center">
    <div class="w-full max-w-lg bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 reveal">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Edit Data Dokter</h2>
        
        <form method="POST" enctype="multipart/form-data">
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nama Dokter</label>
                <input type="text" name="nama" value="{{ dokter.nama }}" required class="w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white p-2.5 focus:ring-green-500 focus:border-green-500">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Spesialis</label>
                <input type="text" name="spesialis" value="{{ dokter.spesialis }}" required class="w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white p-2.5 focus:ring-green-500 focus:border-green-500">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Jadwal Praktik</label>
                <input type="text" name="jadwal" value="{{ dokter.jadwal }}" required class="w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white p-2.5 focus:ring-green-500 focus:border-green-500">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Foto Baru (Opsional)</label>
                <input type="file" name="foto_file" id="foto_file" accept=".jpg,.jpeg,.png" class="w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white p-2.5 focus:ring-green-500 focus:border-green-500">
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Format: JPG, JPEG, PNG (Max 5MB)</p>
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ATAU URL Foto</label>
                <input type="url" name="foto_url" id="foto_url" placeholder="https://example.com/photo.jpg" class="w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white p-2.5 focus:ring-green-500 focus:border-green-500">
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Kosongkan keduanya jika tidak ingin mengubah foto</p>
            </div>

            {% if dokter.foto %}
            <div class="mb-6 bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                <p class="text-sm text-gray-600 dark:text-gray-300 font-medium mb-2">Foto Saat Ini:</p>
                {% if dokter.foto.startswith('http') %}
                <img src="{{ dokter.foto }}" alt="{{ dokter.nama }}" class="w-32 h-32 object-cover rounded-lg mx-auto">
                {% else %}
                <img src="{{ url_for('static', filename=dokter.foto) }}" alt="{{ dokter.nama }}" class="w-32 h-32 object-cover rounded-lg mx-auto">
                {% endif %}
            </div>
            {% endif %}

            <div class="flex gap-4">
                <button type="submit" class="flex-1 bg-green-700 text-white py-3 rounded-lg font-bold hover:bg-green-800 transition">Simpan Perubahan</button>
                <a href="{{ url_for('jadwal_dokter') }}" class="flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-white py-3 rounded-lg font-bold hover:bg-gray-400 dark:hover:bg-gray-500 transition text-center">Batal</a>
            </div>
        </form>
    </div>
</div>

<script>
    const fileInput = document.getElementById('foto_file');
    const urlInput = document.getElementById('foto_url');

    fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
            urlInput.disabled = true;
            urlInput.classList.add('opacity-50', 'cursor-not-allowed');
            urlInput.value = '';
        } else {
            urlInput.disabled = false;
            urlInput.classList.remove('opacity-50', 'cursor-not-allowed');
        }
    });

    urlInput.addEventListener('input', function() {
        if (this.value.trim() !== '') {
            fileInput.disabled = true;
            fileInput.classList.add('opacity-50', 'cursor-not-allowed');
        } else {
            fileInput.disabled = false;
            fileInput.classList.remove('opacity-50', 'cursor-not-allowed');
        }
    });
</script>
{% endblock %}
